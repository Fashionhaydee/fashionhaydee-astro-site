---
import Layout from '../layouts/Layout.astro';

const postImports = import.meta.glob('./blog/*.astro', { eager: true });

const posts = Object.values(postImports).map((mod) => ({
  url: mod.url,
  ...mod.frontmatter
}));

const byCategory = {};

for (const post of posts) {
  const cat = post.category ?? 'Uncategorized';
  if (!byCategory[cat]) byCategory[cat] = [];
  byCategory[cat].push(post);
}
---

<Layout title="Jewelry Blog">
  <h1>Jewelry Journal Â· Explore by Theme</h1>
  {Object.entries(byCategory).map(([category, posts]) => (
    <section>
      <h2>{category}</h2>
      <ul>
        {posts.map((post) => (
          <li>
            <a href={post.url}><strong>{post.title}</strong></a><br/>
            <p>{post.summary}</p>
          </li>
        ))}
      </ul>
    </section>
  ))}
</Layout>
